(function(){function u(a){return"function"==typeof a}function t(a){return"string"==typeof a||a===""+a}function W(a){return"object"===typeof a&&5===ca(a)}function da(a){if(null===a||"object"!=typeof a)return!1;a=ca(a);return 2<a||-1==a}function Z(a){return"object"==typeof a&&3===ca(a)&&!a.nodeType&&a.constructor===Object}function la(a){return!0===a||!1===a}function G(){}function Ba(a,c,b,d,e,f){e=e||"before";return function(){if("instead"==e)return c.apply(b||d,arguments);if("before"==e){var h=c.apply(b||
d,arguments);var g=!1!==h?a.apply(d||b,arguments):null}else g=a.apply(d||b,arguments),h=c.apply(b||d,arguments);return f?h:g}}function ea(){return!1}function fa(){return!0}function M(a,c){var b;if(b=c)b=!(c&&ra("(?:^|\\s)"+c+"(?!\\S)").test(a.className));b&&(a.className+=" "+c)}function I(a,c){c&&(a.className=a.className.replace(ra("(?:^|\\s)"+c+"(?!\\S)"),""))}function ha(a){if(a&&void 0!=!a.length&&a!==""+a){for(var c=[],b=-1,d=a.length>>>0;++b!==d;c[b]=a[b]);return c}return a?[a]:[]}function n(a,
c){return a.getAttribute?a.getAttribute(c):null}function aa(a,c,b,d){return setTimeout(function(){a.apply(c,b||[])},d||0)}function sa(a,c){if(!a||!t(a))return null;try{var b=new DOMParser;var d=b.parseFromString(a,c||"text/xml")}catch(e){d=void 0}if(!d||d.getElementsByTagName("parsererror").length)throw"Invalid XML: "+a;return d}function H(a){if(!a)return!1;var c,b;return"object"!=(b=typeof a)&&"function"!=b?!1:u(c=a.then)?c:!1}function ma(a,c,b){var d,e=a.childNodes;if(!1!==c.call(b,a))for(a=-1,
d=e.length>>>0;++a!==d;ma(e[a],c,b));}var F={},Ca=Object.prototype.toString,ca=function(){var a={"[object String]":0,"[object Number]":1,"[object Boolean]":2,"[object Object]":3,"[object Function]":4,"[object Array]":5,"[object RegExp]":9,"[object Date]":10};return function(c){if(!c){if(null===c)return 6;if(void 0===c)return 7}var b=a[Ca.call(c)];return void 0===b?-1:1===b&&isNaN(c)?8:b}}(),Da=function(){var a,c=function(b){var c={},e=[];0==arguments.length&&(b=!0);return{addFinder:function(a,b,g){e[g?
"unshift":"push"]({fn:a,context:b})},add:function(a,d,g){if(c[a]&&!1===c[a].rewritable)return c[a];c[a]={rewritable:"undefined"!=typeof g?g:b,value:d};return d},get:function(a){if(c[a])return c[a].value;if(e.length){var b;var g=0;for(b=e.length;g<b;g++){var f=e[g].fn.call(e[g].context,a,this);if(void 0!==f)return this.add(a,f,!0)}}},remove:function(a){var b=c[a];b&&!0===b.rewritable&&delete c[a];return b?b.value:void 0},exists:function(a){return!!c[a]},eachEntry:function(a,b){for(var g in c)a.call(b,
c[g].value,g)},destroy:function(){this===a&&(a=null);this.remove=this.exists=this.destroy=this.get=this.add=b=c=null}}};c.global=function(){a||(a=new c(!0));return a};return c}(),na=function(){var a=function(a,c,f){f=f||new Da(!1);var d=c?c.length:null;a||(a="undefined"!==typeof global?global:window);var g=function(a){return a&&c&&a.substr(0,d)!==c?c+"."+a:a},k=function(b,k){b=g(b);if(f.exists(b))return f.get(b);if(!k){k=b.split(".");var d,h=k.length,e=a;for(d=0;d<h;d++){var m=k[d];if(c&&0===d&&m===
c)e=a;else{if(void 0===e[m])return;e=e[m]}}e&&f.add(b,e);return e}};this.register=function(b,k){b=g(b);var d=b.split("."),h=d.pop();var e=d.join(".");var m=d.length,p=a;if(f[e])b=[f[e],h,b];else{if(0<m)for(e=0;e<m;e++){var E=d[e];c&&0===e&&E===c?p=a:(void 0===p[E]&&(p[E]={}),p=p[E])}b=[p,h,b]}d=b[0];h=b[1];da(d)&&void 0===d[h]&&(d[h]=k,f.add(b[2],k));return k};this.exists=function(a){return void 0!==k(a,!0)};this.get=k;this.add=function(a,b){a=g(a);f.add(a,b);return b};this.remove=function(a){a=g(a);
f.remove(a)};this.normalize=g;this.makeAlias=function(a,b){a=g(a);b=g(b);a=f.get(a);void 0!==a&&f.add(b,a)};this.destroy=function(){var a;this===b&&(b=null);f.eachEntry(function(a){a&&a.$destroy&&a.$destroy()});f.destroy();f=null;for(a in this)this[a]=null}},c=a.prototype;c=c.register=c.exists=c.get=c.add=c.remove=c.normalize=c.makeAlias=c.destroy=null;var b;a.global=function(){b||(b=new a);return b};return a}(),J=Array.prototype.slice,r=function(){return function c(){var b=!1,d=!1,e=J.call(arguments),
f=e.shift(),h,g,k;la(e[e.length-1])&&(b=e.pop());la(e[e.length-1])&&(d=b,b=e.pop());for(;e.length;)if((h=e.shift())&&h.hasOwnProperty)for(g in h)if(h.hasOwnProperty(g)&&void 0!==(k=h[g]))if(d)if(f[g]&&Z(f[g])&&Z(k))c(f[g],k,b,d);else{if(!0===b||void 0==f[g])Z(k)?(f[g]={},c(f[g],k,b,!0)):f[g]=k}else if(!0===b||void 0==f[g])f[g]=k;return f}}(),Ea=function(a,c){var b=function(){};b.prototype=a.prototype;b=new b;a=a.apply(b,c);return da(a)||!1===a?a:b},oa=function(){var a=function(){this.$super&&this.$super!==
G&&this.$super.apply(this,arguments)},c=function(a,b,g){var $super=a.prototype[b]||("$constructor"===b?a:G)||G;return function(){var a=this.$super;if(this.$destroyed)return this.$super=null;this.$super=$super;var b=g.apply(this,arguments);this.$super=a;return b}},b=function(a,b,g,k){var f,d=g.prototype;for(f in b)if(b.hasOwnProperty(f)){var h=d[f];var e=b[f];a[f]=!u(e)||h&&!u(h)?e:c(g,f,e)}k||(a.$plugins=null,a.$pluginMap=null,d.$beforeInit?(a.$beforeInit=d.$beforeInit.slice(),a.$afterInit=d.$afterInit.slice(),
a.$beforeDestroy=d.$beforeDestroy.slice(),a.$afterDestroy=d.$afterDestroy.slice()):(a.$beforeInit=[],a.$afterInit=[],a.$beforeDestroy=[],a.$afterDestroy=[]))},d=function(c){c||(c=new na);var f=function(a){return function(){var b=[],g=[],f=arguments,k,d;if(!this)throw"Must instantiate via new: "+a;this.$plugins=[];(k=this.$constructor.apply(this,arguments))&&W(k)&&(f=k);var h=this.$plugins;var e=this.$pluginMap={};k=-1;for(d=this.$beforeInit.length;++k<d;b.push([this.$beforeInit[k],this]));k=-1;for(d=
this.$afterInit.length;++k<d;g.push([this.$afterInit[k],this]));if(h&&h.length)for(k=0,d=h.length;k<d;k++){var m=h[k];if(t(m)){var q=m;m=c.get(m,!0);if(!m)throw q+" not found";}m=new m(this,f);e[m.$class]=m;m.$beforeHostInit&&b.push([m.$beforeHostInit,m]);m.$afterHostInit&&g.push([m.$afterHostInit,m]);h[k]=m}k=-1;for(d=b.length;++k<d;b[k][0].apply(b[k][1],f));this.$init&&this.$init.apply(this,f);k=-1;for(d=g.length;++k<d;g[k][0].apply(g[k][1],f));}},g=function(){};r(g.prototype,{$class:null,$extends:null,
$plugins:null,$pluginMap:null,$mixins:null,$destroyed:!1,$destroying:!1,$constructor:G,$init:G,$beforeInit:[],$afterInit:[],$beforeDestroy:[],$afterDestroy:[],$getClass:function(){return this.$class},$is:function(a){return m(this,a)},$getParentClass:function(){return this.$extends},$intercept:function(a,b,c,g,k){var f=this[a];this[a]=Ba(f||G,b,c||this,this,g,k);return f||G},$implement:function(a){var c=this.constructor;c&&c.$parent&&b(this,a,c.$parent,!0)},$hasPlugin:function(a){return!!this.$pluginMap[c.normalize(a)]},
$getPlugin:function(a){return this.$pluginMap[c.normalize(a)]||null},$bind:function(a){var b=this;return function(){if(!b.$isDestroyed())return a.apply(b,arguments)}},$isDestroyed:function(){return p.$destroying||p.$destroyed},$destroy:function(){var a=this.$beforeDestroy,b=this.$afterDestroy,c=this.$plugins,g;if(!this.$destroying&&!this.$destroyed){this.$destroying=!0;var k=-1;for(g=a.length;++k<g;a[k].apply(this,arguments));k=0;for(g=c.length;k<g;k++)c[k].$beforeHostDestroy&&c[k].$beforeHostDestroy.call(c[k],
arguments);a=this.destroy.apply(this,arguments);k=-1;for(g=b.length;++k<g;b[k].apply(this,arguments));k=0;for(g=c.length;k<g;k++)c[k].$destroy.apply(c[k],arguments);if(!1!==a)for(k in this)this.hasOwnProperty(k)&&(this[k]=null);this.$destroying=!1;this.$destroyed=!0}},destroy:function(){}});g.$self=g;g.$instantiate=function(){var a=arguments;switch(a.length){case 0:return new this;case 1:return new this(a[0]);case 2:return new this(a[0],a[1]);case 3:return new this(a[0],a[1],a[2]);case 4:return new this(a[0],
a[1],a[2],a[3]);default:return Ea(this,a)}};g.$override=function(a){var c=this.$self,g=this.$parent;c&&g&&b(c.prototype,a,g)};g.$extend=function(a,b){return k(a,b,this)};g.$destroy=function(){for(var a in this)this[a]=null};var k=function(k,d,h){k=k||{};var e=k.$class,C=h||k.$extends,m=k.$mixins;h=k.$alias;var p,q;if(C)if(t(C))var D=c.get(C);else D=C,C=D.$class||"";else D=g,C="";if(C&&!D)throw C+" not found";e&&(e=c.normalize(e));k.$class=e;k.$extends=C;k.$mixins=null;C=Object.create(D.prototype);
k.$constructor=k.$constructor||a;b(C,k,D);if(m)for(k=0,p=m.length;k<p;k++){var l=m[k];t(l)&&(l=c.get(l,!0));var z=void 0,w=C;for(z in l)l.hasOwnProperty(z)&&("$beforeInit"===z?w.$beforeInit.push(l[z]):"$afterInit"===z?w.$afterInit.push(l[z]):"$beforeDestroy"===z?w.$beforeDestroy.push(l[z]):"$afterDestroy"===z?w.$afterDestroy.push(l[z]):w[z]||(w[z]=l[z]))}m=f(e);C.constructor=m;C.$self=m;m.prototype=C;for(q in g)"prototype"!==q&&g.hasOwnProperty(q)&&(m[q]=g[q]);for(q in D)"prototype"!==q&&D.hasOwnProperty(q)&&
(m[q]=D[q]);if(d)for(q in d)"prototype"!==q&&d.hasOwnProperty(q)&&(m[q]=d[q]);m.$parent=D;m.$self=m;e&&c.register(e,m);h&&c.register(h,m);return m},m=function(a,b){return(b=t(b)?c.get(b):b)?a instanceof b:!1},p=this;p.factory=function(a){var b=c.get(a),g=J.call(arguments,1);if(!b)throw a+" not found";return b.$instantiate.apply(b,g)};p.isSubclassOf=function(a,b){var g=a,k=c.get;b=t(b)?c.normalize(b):b.prototype.$class;for(t(a)&&(g=k(c.normalize(a)));g&&g.prototype;){if(g.prototype.$class===b)return!0;
g=g.$parent}return!1};p.isInstanceOf=m;p.define=k;p.destroy=function(){p===e&&(e=null);g.$destroy();g=null;c.destroy();d=c=null};p.BaseClass=g};d.prototype={factory:null,isSubclassOf:null,isInstanceOf:null,define:null,destroy:null};var e;d.global=function(){e||(e=new d(na.global()));return e};return d}(),v=new na(F,"MetaphorJs"),K=(new oa(v)).define,l=Function.prototype.bind?function(a,c){return a.bind(c)}:function(a,c){return function(){return a.apply(c,arguments)}},L=function(a){if(a instanceof
L)return a;if(!(this instanceof L))return new L(a);for(var c in a)if(!this[c])try{this[c]=a[c]}catch(e){}this.originalEvent=a;this.type=a.type;!this.target&&a.srcElement&&(this.target=a.srcElement);var b=a.button;if(void 0===this.pageX&&null!==a.clientX){var d=this.target?this.target.ownerDocument||window.document:window.document;c=d.documentElement;d=d.body;this.pageX=a.clientX+(c&&c.scrollLeft||d&&d.scrollLeft||0)-(c&&c.clientLeft||d&&d.clientLeft||0);this.pageY=a.clientY+(c&&c.scrollTop||d&&d.scrollTop||
0)-(c&&c.clientTop||d&&d.clientTop||0)}this.which||void 0===b||(this.which=b&1?1:b&2?3:b&4?2:0);this.isDefaultPrevented=a.defaultPrevented||void 0===a.defaultPrevented&&!1===a.returnValue?fa:ea;this.timeStamp=a&&a.timeStamp||(new Date).getTime()};r(L.prototype,{isDefaultPrevented:ea,isPropagationStopped:ea,isImmediatePropagationStopped:ea,preventDefault:function(){var a=this.originalEvent;this.isDefaultPrevented=fa;a.returnValue=!1;a&&a.preventDefault&&a.preventDefault()},stopPropagation:function(){var a=
this.originalEvent;this.isPropagationStopped=fa;a.cancelBubble=!0;a&&a.stopPropagation&&a.stopPropagation()},stopImmediatePropagation:function(){var a=this.originalEvent;this.isImmediatePropagationStopped=fa;a&&a.stopImmediatePropagation&&a.stopImmediatePropagation();this.stopPropagation()}},!0,!1);var ta=function(a){function c(){d=null}var b,d;a=function(a){return function(f){var h=new L(f||window.event),g=J.call(arguments,1),k=0,e=0,p=0,q=0;h.type="mousewheel";"detail"in h&&(e=-1*h.detail);"wheelDelta"in
h&&(e=h.wheelDelta);"wheelDeltaY"in h&&(e=h.wheelDeltaY);"wheelDeltaX"in h&&(k=-1*h.wheelDeltaX);"axis"in h&&h.axis===h.HORIZONTAL_AXIS&&(k=-1*e,e=0);var C=0===e?k:e;"deltaY"in h&&(C=e=-1*h.deltaY);"deltaX"in h&&(k=h.deltaX,0===e&&(C=-1*k));if(0!==e||0!==k){var D=Math.max(Math.abs(e),Math.abs(k));if(!d||D<d)d=D,"mousewheel"===h.type&&0===D%120&&(d/=40);"mousewheel"===h.type&&0===D%120&&(C/=40,k/=40,e/=40);C=Math[1<=C?"floor":"ceil"](C/d);k=Math[1<=k?"floor":"ceil"](k/d);e=Math[1<=e?"floor":"ceil"](e/
d);this.getBoundingClientRect&&(D=this.getBoundingClientRect(),p=h.clientX-D.left,q=h.clientY-D.top);h.deltaX=k;h.deltaY=e;h.deltaFactor=d;h.offsetX=p;h.offsetY=q;h.deltaMode=0;g.unshift(h,C,k,e);b&&clearTimeout(b);b=setTimeout(c,200);return a.apply(this,g)}}};a.events=function(){var a=window.document;return"onwheel"in a||9<=a.documentMode?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"]};return a}(),T=function(){var a=null,c=null;return function(b,d,e){null===a&&(b.addEventListener?
(a="addEventListener",c=""):(a="attachEvent",c="on"));if("mousewheel"==d){e=ta(e);d=ta.events();var f;var h=0;for(f=d.length;h<f;h++)b[a](c+d[h],e,!1)}else b[a](c+d,e,!1);return e}}(),ua=function(){var a=null,c=null;return function(b,d,e){null===a&&(b.removeEventListener?(a="removeEventListener",c=""):(a="detachEvent",c="on"));b[a](c+d,e)}}(),ra=function(){var a={};return function(c){return a[c]||(a[c]=new RegExp(c))}}(),U=function(){var a=/^[\w[:#.][\w\]*^|=!]*$/,c=/=([^\]]+)/,b=/ *, */,d=/(\([^)]*)\+/,
e=/(\[[^\]]+)~/,f=/(~|>|\+)/,h=/ +/,g=/([^[:.#]+)?(?:#([^[:.#]+))?(?:\.([^[:.]+))?(?:\[([^!&^*|$[:=]+)([!$^*|&]?=)?([^:\]]+)?\])?(?::([^(]+)(?:\(([^)]+)\))?)?/,k=/(?:(-?\d*)n)?(?:(%|-)(\d*))?/,m=/\D/,p=/[^(]*\(([^)]*)\)/,q=/\(.*/,C=/\[([^!~^*|$ [:=]+)([$^*|]?=)?([^ :\]]+)?\]/,D=window.document,ia=!!D.getElementsByClassName,O=!!D.querySelectorAll,E={"first-child":function(a){return a.parentNode.getElementsByTagName("*")[0]!==a},"last-child":function(a){for(;(a=a.nextSibling)&&1!==a.nodeType;);return!!a},
root:function(a){return"html"!==a.nodeName.toLowerCase()},"nth-child":function(a,b){var g=a.nodeIndex||0,c=b[3]=b[3]?("%"===b[2]?-1:1)*b[3]:0;b=b[1];if(g)return!((g+c)%b);var k=a.parentNode.firstChild;g++;do if(1===k.nodeType&&(k.nodeIndex=++g)&&a===k&&(g+c)%b)return 0;while(k=k.nextSibling);return 1},"nth-last-child":function(a,b){var g=a.nodeIndexLast||0,c=b[3]?("%"===b[2]?-1:1)*b[3]:0;b=b[1];if(g)return!((g+c)%b);var k=a.parentNode.lastChild;g++;do if(1===k.nodeType&&(k.nodeLastIndex=g++)&&a===
k&&(g+c)%b)return 0;while(k=k.previousSibling);return 1},empty:function(a){return!!a.firstChild},parent:function(a){return!a.firstChild},"only-child":function(a){return 1!==a.parentNode.getElementsByTagName("*").length},checked:function(a){return!a.checked},lang:function(a,b){return a.lang!==b&&D.documentElement.lang!==b},enabled:function(a){return a.disabled||"hidden"===a.type},disabled:function(a){return!a.disabled},selected:function(a){return!a.selected}},l={},u=function(a){return l[a]||(l[a]=
new RegExp("(^| +)"+a+"($| +)"))},r={"":function(a,b){return null!==n(a,b)},"=":function(a,b,g){var c;return(c=n(a,b))&&c===g},"&=":function(a,b,g){var c;return(c=n(a,b))&&u(g).test(c)},"^=":function(a,b,g){var c;return(c=n(a,b)+"")&&!c.indexOf(g)},"$=":function(a,b,g){var c;return(c=n(a,b)+"")&&c.indexOf(g)===c.length-g.length},"*=":function(a,b,g){var c;return(c=n(a,b)+"")&&-1!==c.indexOf(g)},"|=":function(a,b,g){var c;return(c=n(a,b)+"")&&(c===g||!!c.indexOf(g+"-"))},"!=":function(a,b,g){var c;
return!(c=n(a,b))||!u(g).test(c)}},t=function(l,w){w=w||D;var x=[],n=null,u,t,A;if(O&&w.querySelectorAll)try{x=ha(w.querySelectorAll(l.replace(c,'="$1"')))}catch(Ka){n=!0}if(!O||n)if(a.test(l))switch(n=0,l.charAt(0)){case "#":n=l.slice(1);x=D.getElementById(n);x.id!==n&&(x=D.all[n]);x=x?[x]:[];break;case ".":l=l.slice(1);if(ia)x=ha((x=w.getElementsByClassName(l)).length?x:[]);else{l=" "+l+" ";var v=w.getElementsByTagName("*");for(u=0;w=v[u++];)-1!==(" "+w.className+" ").indexOf(l)&&(x[n++]=w);x=n?
x:[]}break;case ":":v=w.getElementsByTagName("*");u=0;var X=l.replace(p,"$1");for(t=l.replace(q,"");w=v[u++];)E[t]&&!E[t](w,X)&&(x[n++]=w);x=n?x:[];break;case "[":v=w.getElementsByTagName("*");u=0;w=C.exec(l);l=w[1];var z=w[2]||"";for(A=w[3];w=v[u++];)r[z]&&(r[z](w,l,A)||"class"===l&&r[z](w,"className",A))&&(x[n++]=w);x=n?x:[];break;default:x=ha((x=w.getElementsByTagName(l)).length?x:[])}else{for(var F=l.split(b),G=F.length-1,L=!!G,I,M,B,J,P,Q,R,S,N,y,H,K;n=F[G--];){M=(I=n.replace(d,"$1%").replace(e,
"$1&").replace(f," $1 ").split(h)).length;u=0;J=" ";for(v=w instanceof DocumentFragment?w.children:[w];B=I[u++];)if(" "!==B&&">"!==B&&"~"!==B&&"+"!==B&&v){B=B.match(g);P=B[1]||"*";Q=B[2];R=B[3]?" "+B[3]+" ":"";l=B[4];z=B[5]||"";t=B[7];X="nth-child"===t||"nth-last-child"===t?k.exec("even"===B[8]&&"2n"||"odd"===B[8]&&"2n%1"||!m.test(B[8])&&"0n%"+B[8]||B[8]):B[8];S=[];n=N=0;for(H=u===M;y=v[N++];)switch(J){case " ":if(y.getElementsByTagName)for(K=y.getElementsByTagName(P),y=0;A=K[y++];)Q&&A.id!==Q||R&&
-1==(" "+A.className+" ").indexOf(R)||!(!l||r[z]&&(r[z](A,l,B[6])||"class"===l&&r[z](A,"className",B[6])))||A.yeasss||(E[t]?E[t](A,X):t)||(H&&(A.yeasss=1),S[n++]=A);break;case "~":for(P=P.toLowerCase();(y=y.nextSibling)&&!y.yeasss;)1!==y.nodeType||"*"!==P&&y.nodeName.toLowerCase()!==P||Q&&y.id!==Q||R&&-1===(" "+y.className+" ").indexOf(R)||!(!l||r[z]&&(r[z](A,l,B[6])||"class"===l&&r[z](A,"className",B[6])))||y.yeasss||(E[t]?E[t](y,X):t)||(H&&(y.yeasss=1),S[n++]=y);break;case "+":for(;(y=y.nextSibling)&&
1!==y.nodeType;);!y||y.nodeName.toLowerCase()!==P.toLowerCase()&&"*"!==P||Q&&y.id!==Q||R&&-1===(" "+A.className+" ").indexOf(R)||!(!l||r[z]&&(r[z](A,l,B[6])||"class"===l&&r[z](A,"className",B[6])))||y.yeasss||(E[t]?E[t](y,X):t)||(H&&(y.yeasss=1),S[n++]=y);break;case ">":if(y.getElementsByTagName)for(K=y.getElementsByTagName(P),u=0;A=K[u++];)A.parentNode!==y||Q&&A.id!==Q||R&&-1==(" "+A.className+" ").indexOf(R)||!(!l||r[z]&&(r[z](A,l,B[6])||"class"===l&&r[z](A,"className",B[6])))||A.yeasss||(E[t]?
E[t](A,X):t)||(H&&(A.yeasss=1),S[n++]=A)}v=S}else J=B;if(L){if(!v.concat){S=[];for(y=0;A=v[y];)S[y++]=A;v=S}x=v.concat(1===x.length?x[0]:x)}else x=v}for(n=x.length;n--;)x[n].yeasss=x[n].nodeIndex=x[n].nodeIndexLast=null}return x};t.is=function(a,b){b=t(b,a.parentNode);var g;var c=-1;for(g=b.length;++c<g;)if(b[c]===a)return!0;return!1};return t}(),ja=function(){var a=["0","0","0"];return function(){for(var c=a.length,b;c;){c--;b=a[c].charCodeAt(0);if(57==b)return a[c]="A",a.join("");if(90==b)a[c]=
"0";else return a[c]=String.fromCharCode(b+1),a.join("")}a.unshift("0");return a.join("")}}(),N=function(){return String.prototype.trim?function(a){return t(a)?a.trim():a}:function(a){return t(a)?a.replace(/^\s\s*/,"").replace(/\s\s*$/,""):a}}(),V=function(){var a=/\r/,c={option:function(a){var b=a.getAttribute("value")||a.value;return void 0!==b?b:N(a.innerText||a.textContent)},select:function(a){for(var b,c=a.options,f=a.selectedIndex,h=(a="select-one"===a.type||0>f)?null:[],g=a?f+1:c.length,k,
m=0>f?g:a?f:0;m<g;m++)if(b=c[m],k=b.disabled||b.parentNode.disabled,(b.selected||m===f)&&!k){b=V(b);if(a)return b;h.push(b)}return h},radio:function(a){return null===a.getAttribute("value")?"on":a.value},checkbox:function(a){return null===a.getAttribute("value")?"on":a.value}};return function(b){var d,e;if((d=c[b.type]||c[b.nodeName.toLowerCase()])&&void 0!==(e=d(b,"value")))return e;e=b.value;return t(e)?e.replace(a,""):null==e?"":e}}(),va=function(){var a=Array.prototype.indexOf;a||(a=Array.prototype.indexOf=
function(a,b){if(null==this)throw new TypeError('"this" is null or not defined');var c=Object(this),e=c.length>>>0;if(0===e)return-1;b=+b||0;Infinity===Math.abs(b)&&(b=0);if(b>=e)return-1;for(b=Math.max(0<=b?b:e-Math.abs(b),0);b<e;){if(b in c&&c[b]===a)return b;b++}return-1});return a}(),wa=function(){var a={select:function(a,b){for(var c,e=a.options,f=ha(b),h=e.length,g,k=-1;h--;)b=e[h],(g=f?-1!==va.call(f,b.value):!1)?(b.setAttribute("selected","selected"),c=b.selected=!0):b.removeAttribute("selected"),
g||null===n(b,"default-option")||(k=h);c||(a.selectedIndex=k);return f}};a.radio=a.checkbox=function(a,b){if(W(b)){var c=V(a);b=b?-1!==va.call(b,c):!1;return a.checked=b}};return function(c,b){if(1===c.nodeType){null===b?b="":1===ca(b)&&(b+="");var d=a[c.type]||a[c.nodeName.toLowerCase()];d&&void 0!==d(c,b,"value")||(c.value=b)}}}(),xa=function(){return function b(c){if(c===window)return!0;if(3==c.nodeType)return c.parentElement?b(c.parentElement):!0;var d=window.document.documentElement;return c===
d?!0:d.contains(c)}}(),Fa=function(){var a=null;return function(){null===a&&(a=parseInt((/android (\d+)/i.exec(navigator.userAgent)||[])[1],10)||!1);return a}}(),Ga=function(){var a;return function(){if(null===a){var c=navigator.userAgent;a=parseInt((/msie (\d+)/i.exec(c)||[])[1],10);isNaN(a)&&(a=parseInt((/trident\/.*; rv:(\d+)/i.exec(c)||[])[1],10)||!1)}return a}}(),ya=function(){var a={},c;return function(b){if(void 0===a[b]){if("input"==b&&9==Ga())return a[b]=!1;c||(c=window.document.createElement("div"));
a[b]=!!("on"+b in c)}return a[b]}}(),pa=function(a,c){this.name=a;this.listeners=[];this.map={};this.hash=ja();this.uni="$$"+a+"_"+this.hash;this.suspended=!1;this.lid=0;"object"===typeof c&&null!==c?r(this,c,!0,!1):this.returnResult=c};r(pa.prototype,{name:null,listeners:null,map:null,hash:null,uni:null,suspended:!1,lid:null,returnResult:null,autoTrigger:null,lastTrigger:null,triggerFilter:null,filterContext:null,expectPromises:!1,resolvePromises:!1,getName:function(){return this.name},destroy:function(){for(var a in this)this[a]=
null},on:function(a,c,b){if(!a)return null;c=c||null;b=b||{};var d=this.uni,e=a||c;if(e[d]&&!b.allowDupes)return null;var f=++this.lid,h=b.first||!1;e[d]=f;a={fn:a,context:c,uniContext:e,id:f,async:!1,called:0,limit:0,start:1,count:0,append:null,prepend:null};r(a,b,!0,!1);!0===a.async&&(a.async=1);h?this.listeners.unshift(a):this.listeners.push(a);this.map[f]=a;if(this.autoTrigger&&this.lastTrigger&&!this.suspended){var g=this.triggerFilter;this.triggerFilter=function(a){return a.id===f?g?!1!==g(a):
!0:!1};this.trigger.apply(this,this.lastTrigger);this.triggerFilter=g}return f},once:function(a,c,b){b=b||{};b.limit=1;return this.on(a,c,b)},un:function(a,c){var b=-1,d=this.uni,e=this.listeners;a=a==parseInt(a)?parseInt(a):(c||a)[d];if(!a)return!1;c=0;for(var f=e.length;c<f;c++)if(e[c].id===a){b=c;delete e[c].uniContext[d];break}if(-1===b)return!1;e.splice(b,1);delete this.map[a];return!0},hasListener:function(a,c){var b=this.listeners;if(a){c=c||a;a=u(a)?c[this.uni]:parseInt(a);if(!a)return!1;
c=0;for(var d=b.length;c<d;c++)if(b[c].id===a)return!0;return!1}return 0<b.length},removeAllListeners:function(){var a=this.listeners,c=this.uni,b;var d=0;for(b=a.length;d<b;d++)delete a[d].uniContext[c];this.listeners=[];this.map={}},suspend:function(){this.suspended=!0},resume:function(){this.suspended=!1},_prepareArgs:function(a,c){if(a.append||a.prepend)c=J.call(c),a.prepend&&(c=a.prepend.concat(c)),a.append&&(c=c.concat(a.append));return c},trigger:function(){var a=this,c=a.listeners,b=a.returnResult,
d=a.triggerFilter,e=a.filterContext,f=a.expectPromises,h=[],g;if(a.suspended)return null;a.autoTrigger&&(a.lastTrigger=J.call(arguments));if(0===c.length)return null;var k="all"===b||"concat"===b?[]:"merge"===b?{}:null,m,p;for(m="first"===b?[c[0]]:J.call(c);p=m.shift();)if(!(!p||!a.map[p.id]||(c=a._prepareArgs(p,arguments),d&&!1===d.call(e,p,c,a))||p.filter&&!1===p.filter.apply(p.filterContext||p.context,c)||(p.count++,p.count<p.start))){if(p.async&&!f){var q=null;aa(p.fn,p.context,c,p.async)}else f?
(q=function(b,g,c){return function(k){"pipe"===g&&(c[0]=k,c=a._prepareArgs(b,c));return b.fn.apply(b.context,c)}}(p,b,J.call(arguments)),q=g?g.then(q):p.fn.apply(p.context,c),q.catch(function(a){console.log(a)})):q=p.fn.apply(p.context,c);p.called++;p.called===p.limit&&a.un(p.id);if("first"===b)return q;if(f)h.push(q),"pipe"===b&&q&&(g=q);else if(null!==b)if("all"===b)k.push(q);else if("concat"===b&&q)k=k.concat(q);else if("merge"===b)r(k,q,!0,!1);else{if("nonempty"===b&&q)return q;if("pipe"===b)k=
q,arguments[0]=q;else if("last"===b)k=q;else{if(!1===b&&!1===q)return!1;if(!0===b&&!0===q)return!0}}}return f?(d=za.all(h),a.resolvePromises&&null!==b&&"all"!==b&&(d=d.then(function(a){var c,g=a.length;for(c=0;c<g;c++){var f=a[c];if("concat"===b&&f)k=k.concat(f);else if("merge"===b)r(k,f,!0,!1);else{if("nonempty"===b&&f)return f;if(!1===b&&!1===f)return!1;if(!0===b&&!0===f)return!0}}return k})),d):k}},!0,!1);var ka=function(){this.events={}};r(ka.prototype,{createEvent:function(a,c){a=a.toLowerCase();
var b=this.events;b[a]||(b[a]=new pa(a,c));return b[a]},getEvent:function(a){a=a.toLowerCase();return this.events[a]},on:function(a,c,b,d){a=a.toLowerCase();var e=this.events;e[a]||(e[a]=new pa(a));return e[a].on(c,b,d)},once:function(a,c,b,d){d=d||{};d.limit=1;return this.on(a,c,b,d)},un:function(a,c,b){a=a.toLowerCase();var d=this.events;d[a]&&d[a].un(c,b)},relayEvent:function(a,c){a.on(c,this.trigger,this,{prepend:"*"===c?null:[c]})},unrelayEvent:function(a,c){a.un(c,this.trigger,this)},hasListener:function(a,
c,b){var d=this.events;if(a)return a=a.toLowerCase(),d[a]?c?d[a].hasListener(c,b):!0:!1;for(a in d)if(d[a].hasListener())return!0;return!1},hasEvent:function(a){return!!this.events[a]},removeAllListeners:function(a){var c=this.events;if(a)c[a]&&c[a].removeAllListeners();else for(a in c)c[a].removeAllListeners()},trigger:function(){var a=arguments[0],c=this.events,b=null;a=a.toLowerCase();if(c[a]){var d=c[a];b=d.trigger.apply(d,J.call(arguments,1))}(d=c["*"])&&d.trigger.apply(d,arguments);return b},
suspendEvent:function(a){a=a.toLowerCase();var c=this.events;c[a]&&c[a].suspend()},suspendAllEvents:function(){var a=this.events,c;for(c in a)a[c].suspend()},resumeEvent:function(a){a=a.toLowerCase();var c=this.events;c[a]&&c[a].resume()},resumeAllEvents:function(){var a=this.events,c;for(c in a)a[c].resume()},destroyEvent:function(a){var c=this.events;c[a]&&(c[a].removeAllListeners(),c[a].destroy(),delete c[a])},destroy:function(){var a=this.events,c;for(c in a)this.destroyEvent(c);for(c in this)this[c]=
null},getApi:function(){if(!this.api){for(var a="createEvent getEvent on un once hasListener removeAllListeners trigger suspendEvent suspendAllEvents resumeEvent resumeAllEvents destroyEvent relayEvent unrelayEvent".split(" "),c={},b,d=-1,e=a.length;++d<e;b=a[d],c[b]=l(this[b],this));this.api=c}return this.api}},!0,!1);var Y=function(a,c,b,d){if(a.$$input){if(c)a.$$input.on("change",c,b);return a.$$input}d=d||{};this.observable=new ka;this.el=a;this.inputType=a.type.toLowerCase();this.dataType=d.type||
n(a,"data-type")||this.inputType;this.listeners=[];if(c)this.onChange(c,b)};r(Y.prototype,{el:null,inputType:null,dataType:null,listeners:null,radio:null,keydownDelegate:null,changeInitialized:!1,destroy:function(){var a;this.observable.destroy();this._addOrRemoveListeners(ua,!0);this.el.$$input=null;for(a in this)this.hasOwnProperty(a)&&(this[a]=null)},_addOrRemoveListeners:function(a,c){var b=this.inputType,d=this.listeners,e=this.radio,f=this.el,h,g;var k=0;for(h=d.length;k<h;k++){var m=!!d[k][2];
if(m===c){if("radio"===b)for(m=0,g=e.length;m<g;m++)a(e[m],d[k][0],d[k][1]);else a(f,d[k][0],d[k][1]);d[k][2]=!c}}},initInputChange:function(){var a=this.inputType;"radio"===a?this.initRadioInput():"checkbox"===a?this.initCheckboxInput():this.initTextInput();this._addOrRemoveListeners(T,!1);this.changeInitialized=!0},initRadioInput:function(){var a=this.el,c=a.name;if(xa(a))a=a.ownerDocument;else for(;a.parentNode;)a=a.parentNode;this.radio=U("input[name="+c+"]",a);this.onRadioInputChangeDelegate=
l(this.onRadioInputChange,this);this.listeners.push(["click",this.onRadioInputChangeDelegate,!1])},initCheckboxInput:function(){this.clicked=!1;this.onCheckboxInputChangeDelegate=l(this.onCheckboxInputChange,this);this.onCheckboxInputClickDelegate=l(this.onCheckboxInputClick,this);this.listeners.push(["click",this.onCheckboxInputClickDelegate,!1]);this.listeners.push(["change",this.onCheckboxInputChangeDelegate,!1])},initTextInput:function(){var a=!1,c=this,b=c.listeners,d;Fa()||(b.push(["compositionstart",
function(){a=!0},!1]),b.push(["compositionend",function(){a=!1;e()},!1]));var e=c.onTextInputChangeDelegate=function(b){if(!a)c.onTextInputChange(b)},f=function(a){d||(d=setTimeout(function(){e(a);d=null},0))},h=function(a){a=a||window.event;var b=a.keyCode;91===b||15<b&&19>b||37<=b&&40>=b||f(a)};ya("input")?b.push(["input",e,!1]):(b.push(["keydown",h,!1]),ya("paste")&&(b.push(["paste",f,!1]),b.push(["cut",f,!1])));b.push(["change",e,!1])},processValue:function(a){switch(this.dataType){case "number":case "float":case "double":if(""===
a||isNaN(a=parseFloat(a)))a=void 0;break;case "int":case "integer":if(""===a||isNaN(a=parseInt(a,10)))a=void 0;break;case "bool":case "boolean":return!("false"===a||"0"===a||0===a||"off"===a||!1===a||""===a)}return a},onTextInputChange:function(a){a=this.getValue();this.observable.trigger("change",this.processValue(a))},_checkboxChange:function(){var a=this.el;this.observable.trigger("change",this.processValue(a.checked?n(a,"value")||!0:!1))},onCheckboxInputChange:function(){this.clicked||this._checkboxChange();
this.clicked=!1},onCheckboxInputClick:function(){this._checkboxChange();this.clicked=!0},onRadioInputChange:function(a){a=a||window.event;this.observable.trigger("change",this.processValue((a.target||a.srcElement).value))},setValue:function(a){var c=this.inputType,b;a=this.processValue(a);if("radio"===c){c=this.radio;var d=0;for(b=c.length;d<b;d++)c[d].checked=this.processValue(c[d].value)==a}else"checkbox"===c?(c=this.el,c.checked=!0===a||a==this.processValue(c.value)):(void 0===a&&(a=""),wa(this.el,
a));this.triggerChange()},getValue:function(){var a=this.inputType,c;if("radio"===a){a=this.radio;var b=0;for(c=a.length;b<c;b++)if(a[b].checked)return this.processValue(a[b].value);return null}return"checkbox"===a?this.processValue(this.el.checked?n(this.el,"value")||!0:!1):this.processValue(V(this.el))},onChange:function(a,c){this.changeInitialized||this.initInputChange();this.observable.on("change",a,c)},unChange:function(a,c){this.observable.un("change",a,c)},onKey:function(a,c,b,d){this.keydownDelegate||
(this.keydownDelegate=l(this.keyHandler,this),this.listeners.push(["keydown",this.keydownDelegate,!1]),T(this.el,"keydown",this.keydownDelegate),this.observable.createEvent("key",{returnResult:!1,triggerFilter:this.keyEventFilter}));this.observable.on("key",c,b,{key:a,prepend:d})},unKey:function(a,c,b){this.observable.un("key",c,b)},keyEventFilter:function(a,c){a=a.key;c=c[0];return"object"!==typeof a?a===c.keyCode:void 0!==a.ctrlKey&&a.ctrlKey!==c.ctrlKey||void 0!==a.shiftKey&&a.shiftKey!==c.shiftKey?
!1:!(void 0!==a.keyCode&&a.keyCode!==c.keyCode)},keyHandler:function(a){a=new L(a||window.event);this.observable.trigger("key",a)},triggerChange:function(){if("createEvent"in document){var a=document.createEvent("HTMLEvents");a.initEvent("change",!1,!0);this.el.dispatchEvent(a)}else this.el.fireEvent("onchange")}},!0,!1);Y.get=function(a,c){return a.$$input?a.$$input:c&&!a.type&&(c=c.$app.getParentCmp(a,!0))&&c.getInputInterface?c.getInputInterface():new Y(a)};Y.getValue=V;Y.setValue=wa;var Ha=function(){return"undefined"!=
typeof JSON?function(a){return JSON.parse(a)}:function(a){return(new Function("return "+a))()}}(),ba=function(){var a=[],c=function(b){var c;var e=0;for(c=a.length;e<c;e++)if(!1===a[e][0].call(a[e][1],b))return;e=(b?b.stack:null)||Error().stack;if("undefined"!=typeof console&&console.error)b&&console.error(b),e&&console.error(e);else throw b;};c.on=function(b,d){c.un(b,d);a.push([b,d])};c.un=function(b,c){var d;var f=0;for(d=a.length;f<d;f++)if(a[f][0]===b&&a[f][1]===c){a.splice(f,1);break}};return c}(),
za=function(){var a=[],c=!1,b="undefined"!==typeof process?process.nextTick:function(a){setTimeout(a,0)},d=function(){c=!0;var g=a.shift();b(function(){g[0].apply(g[1],g[2]);a.length?d():c=!1},0)},e=function(b,k,f){f=f||[];a.push([b,k,f]);c||d()},f=function(a,b){return function(c){try{b.resolve(a(c))}catch(p){b.reject(p)}}},h=function(a,b){if(a instanceof h)return a;if(!(this instanceof h))return new h(a,b);var c;this._fulfills=[];this._rejects=[];this._dones=[];this._fails=[];if(0<arguments.length)if(c=
H(a))a instanceof h?a.then(l(this.resolve,this),l(this.reject,this)):(new h(c,a)).then(l(this.resolve,this),l(this.reject,this));else if(u(a))try{a.call(b,l(this.resolve,this),l(this.reject,this))}catch(p){this.reject(p)}else this.resolve(a)};r(h.prototype,{_state:0,_fulfills:null,_rejects:null,_dones:null,_fails:null,_wait:0,_value:null,_reason:null,_triggered:!1,isPending:function(){return 0===this._state},isFulfilled:function(){return 1===this._state},isResolved:function(){return 1===this._state},
isRejected:function(){return 2===this._state},hasListeners:function(){var a=[this._fulfills,this._rejects,this._dones,this._fails],b;var c=0;for(b=a.length;c<b;c++)if(a[c]&&a[c].length)return!0;return!1},_cleanup:function(){this._fails=this._dones=this._rejects=this._fulfills=null},_processValue:function(a,b){var c;if(0===this._state)if(a===this)this._doReject(new TypeError("cannot resolve promise with itself"));else{try{if(c=H(a)){a instanceof h?a.then(l(this._processResolveValue,this),l(this._processRejectReason,
this)):(new h(c,a)).then(l(this._processResolveValue,this),l(this._processRejectReason,this));return}}catch(p){0===this._state&&this._doReject(p);return}b.call(this,a)}},_callResolveHandlers:function(){this._done();for(var a=this._fulfills,b;b=a.shift();)e(b[0],b[1],[this._value]);this._cleanup()},_doResolve:function(a){this._value=a;this._state=1;0===this._wait&&this._callResolveHandlers()},_processResolveValue:function(a){this._processValue(a,this._doResolve)},resolve:function(a){if(this._triggered)return this;
this._triggered=!0;this._processResolveValue(a);return this},_callRejectHandlers:function(){this._fail();for(var a=this._rejects,b;b=a.shift();)e(b[0],b[1],[this._reason]);this._cleanup()},_doReject:function(a){this._state=2;this._reason=a;0===this._wait&&this._callRejectHandlers()},_processRejectReason:function(a){this._processValue(a,this._doReject)},reject:function(a){if(this._triggered)return this;this._triggered=!0;this._processRejectReason(a);return this},then:function(a,b,c){var g=new h,k=
this._state;c&&(a&&(a=l(a,c)),b&&(b=l(b,c)));0===k||0!==this._wait?(a&&u(a)?this._fulfills.push([f(a,g),null]):this._fulfills.push([g.resolve,g]),b&&u(b)?this._rejects.push([f(b,g),null]):this._rejects.push([g.reject,g])):1===k?a&&u(a)?e(f(a,g),null,[this._value]):g.resolve(this._value):2===k&&(b&&u(b)?e(f(b,g),null,[this._reason]):g.reject(this._reason));return g},"catch":function(a){return this.then(null,a)},_done:function(){for(var a=this._dones,b;b=a.shift();)try{b[0].call(b[1]||null,this._value)}catch(m){ba(m)}},
done:function(a,b){var c=this._state;if(1===c&&0===this._wait)try{a.call(b||null,this._value)}catch(p){ba(p)}else 0===c&&this._dones.push([a,b]);return this},_fail:function(){for(var a=this._fails,b;b=a.shift();)try{b[0].call(b[1]||null,this._reason)}catch(m){ba(m)}},fail:function(a,b){var c=this._state;if(2===c&&0===this._wait)try{a.call(b||null,this._reason)}catch(p){ba(p)}else 0===c&&this._fails.push([a,b]);return this},always:function(a,b){this.done(a,b);this.fail(a,b);return this},promise:function(){return{then:l(this.then,
this),done:l(this.done,this),fail:l(this.fail,this),always:l(this.always,this)}},after:function(a){var b=this;if(H(a)){b._wait++;var c=function(){b._wait--;0===b._wait&&0!==b._state&&(1===b._state?b._callResolveHandlers():b._callRejectHandlers())};u(a.done)?a.done(c):a.then(c)}return b}},!0,!1);h.fcall=function(a,b,c){return h.resolve(a.apply(b,c||[]))};h.resolve=function(a){var b=new h;b.resolve(a);return b};h.reject=function(a){var b=new h;b.reject(a);return b};h.all=function(a){if(!a.length)return h.resolve(null);
var b=new h,c=a.length,g=Array(c),f=c,d,e,l=function(a,c){g[c]=a;f--;0===f&&b.resolve(g)};for(d=0;d<c;d++)(function(c){e=a[d];e instanceof h?e.done(function(a){l(a,c)}).fail(b.reject,b):H(e)||u(e)?(new h(e)).done(function(a){l(a,c)}).fail(b.reject,b):l(e,c)})(d);return b};h.when=function(){return h.all(arguments)};h.allResolved=function(a){if(!a.length)return h.resolve(null);var b=new h,c=a.length,g=[],f=c,d,e=function(a){g.push(a);l()},l=function(){f--;0===f&&b.resolve(g)};for(d=0;d<c;d++){var O=
a[d];O instanceof h?O.done(e).fail(l):H(O)||u(O)?(new h(O)).done(e).fail(l):e(O)}return b};h.race=function(a){if(!a.length)return h.resolve(null);var b=new h,c=a.length,g;for(g=0;g<c;g++){var f=a[g];f instanceof h?f.done(b.resolve,b).fail(b.reject,b):H(f)||u(f)?(new h(f)).done(b.resolve,b).fail(b.reject,b):b.resolve(f);if(!b.isPending())break}return b};h.waterfall=function(a){if(!a.length)return h.resolve(null);var b=a.shift();b=u(b)?h.fcall(b):h.resolve(c);for(var c;c=a.shift();)H(c)?b=b.then(function(a){return function(){return a}}(c)):
u(c)?b=b.then(c):b.resolve(c);return b};h.forEach=function(a,b,c,f){var g=a.slice(),d=new h,k=[],e=0,m=function(){if(g.length){var a=g.shift(),C=e;e++;h.fcall(b,c,[a,C]).done(function(a){k.push(a);m()}).fail(function(a){f?d.reject(a):(k.push(null),m())})}else d.resolve(k)};m();return d};h.counter=function(a){var b=new h;b.countdown=function(){a--;0===a&&b.resolve()};return b};return h}(),Aa=function(){function a(c,e,f){var d;if(W(e)){var g=0;for(d=e.length;g<d;g++){var k=e[g];b.test(c)?f(c,k):a(c+
"["+("object"===typeof k?g:"")+"]",k,f)}}else if(Z(e))for(g in e)a(c+"["+g+"]",e[g],f);else f(c,e)}var c=/%20/g,b=/\[\]$/;return function(b){var d,f=[],h=function(a,b){b=u(b)?b():null==b?"":b;f[f.length]=encodeURIComponent(a)+"="+encodeURIComponent(b)};for(d in b)a(d,b[d],h);return f.join("&").replace(c,"+")}}();v.register("mixin.Promise",{$$promise:null,$beforeInit:function(){this.$$promise=new za},then:function(){return this.$$promise.then.apply(this.$$promise,arguments)},done:function(){this.$$promise.done.apply(this.$$promise,
arguments);return this},always:function(){this.$$promise.always.apply(this.$$promise,arguments);return this},fail:function(){this.$$promise.fail.apply(this.$$promise,arguments);return this}});(function(){var a={xml:"application/xml, text/xml",html:"text/html",script:"text/javascript, application/javascript",json:"application/json, text/javascript",text:"text/plain",_default:"*/*"};return K({$class:"ajax.transport.XHR",type:"xhr",_xhr:null,_deferred:null,_ajax:null,$init:function(a,b,d){var c;window.XMLHttpRequest&&
(c=new XMLHttpRequest)||(c=new ActiveXObject("Msxml2.XMLHTTP"));this._xhr=c;this._deferred=b;this._opt=a;this._ajax=d;a.progress&&(c.onprogress=l(a.progress,a.context));a.uploadProgress&&c.upload&&(c.upload.onprogress=l(a.uploadProgress,a.context));c.onreadystatechange=l(this.onReadyStateChange,this)},setHeaders:function(){var c=this._opt,b=this._xhr,d;if(c.xhrFields)for(d in c.xhrFields)b[d]=c.xhrFields[d];c.data&&c.contentType&&b.setRequestHeader("Content-Type",c.contentType);b.setRequestHeader("X-Requested-With",
"XMLHttpRequest");b.setRequestHeader("Accept",c.dataType&&a[c.dataType]?a[c.dataType]+", */*; q=0.01":a._default);for(d in c.headers)b.setRequestHeader(d,c.headers[d])},onReadyStateChange:function(){var a=this._xhr,b=this._deferred;if(0===a.readyState)a.onreadystatechange=G,b.resolve(a);else if(4===a.readyState){a.onreadystatechange=G;a:{try{var d=!a.status&&location&&"file:"==location.protocol||200<=a.status&&300>a.status||304===a.status||1223===a.status;break a}catch(e){}d=!1}if(d)this._ajax.processResponse(t(a.responseText)?
a.responseText:void 0,a.getResponseHeader("content-type")||"");else{a.responseData=null;try{a.responseData=this._ajax.returnResponse(t(a.responseText)?a.responseText:void 0,a.getResponseHeader("content-type")||"")}catch(e){}b.reject(a)}}},abort:function(){this._xhr.onreadystatechange=G;this._xhr.abort()},send:function(){var a=this._opt;try{this._xhr.open(a.method,a.url,!0,a.username,a.password),this.setHeaders(),this._xhr.send(a.data)}catch(b){this._deferred&&this._deferred.reject(b)}}})})();K({$class:"ajax.transport.Script",
type:"script",_opt:null,_deferred:null,_ajax:null,_el:null,$init:function(a,c,b){this._opt=a;this._ajax=b;this._deferred=c},send:function(){var a=document.createElement("script");a.setAttribute("async","async");a.setAttribute("charset","utf-8");a.setAttribute("src",this._opt.url);T(a,"load",l(this.onLoad,this));T(a,"error",l(this.onError,this));document.head.appendChild(a);this._el=a},onLoad:function(a){this._deferred&&this._deferred.resolve(a)},onError:function(a){this._deferred.reject(a)},abort:function(){this._el.parentNode&&
this._el.parentNode.removeChild(this._el)},destroy:function(){this._el.parentNode&&this._el.parentNode.removeChild(this._el)}});K({$class:"ajax.transport.IFrame",type:"iframe",_opt:null,_deferred:null,_ajax:null,_el:null,_sent:!1,$init:function(a,c,b){this._opt=a;this._ajax=b;this._deferred=c},send:function(){var a=this,c=document.createElement("iframe"),b="frame-"+ja(),d=a._opt.form;c.setAttribute("id",b);c.setAttribute("name",b);c.style.display="none";document.body.appendChild(c);d.setAttribute("action",
a._opt.url);d.setAttribute("target",b);T(c,"load",l(a.onLoad,a));T(c,"error",l(a.onError,a));a._el=c;var e=0,f=function(){e++;try{d.submit(),a._sent=!0}catch(h){2<e?a._deferred.reject(h):aa(f,null,[],1E3)}};f()},onLoad:function(){var a=this._el;if(this._sent&&this._opt&&!this._opt.jsonp)try{var c=a.contentDocument||a.contentWindow.document;var b=c.body.innerHTML;this._ajax.processResponse(b)}catch(d){this._deferred.reject(d)}},onError:function(a){this._sent&&this._deferred.reject(a)},abort:function(){this._el.parentNode&&
this._el.parentNode.removeChild(this._el)},destroy:function(){this._el.parentNode&&this._el.parentNode.removeChild(this._el)}});(function(){var a=/\?/,c=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,b=/#.*$/,d=/([?&])_=[^&]*/,e=new ka,f=!(!window||!window.FormData),h=function(a,b,c){var g=b?b.dataType:null;b=b?b.selector:null;if(!t(a))return a;c=c||"";if("xml"===g||!g&&0<=c.indexOf("xml"))return a=sa(N(a)),b?U(b,a):a;if("html"===g)return a=sa(a,"text/html"),b?U(b,a):a;if("fragment"==
g){c=document.createDocumentFragment();g=document.createElement("div");for(g.innerHTML=a;g.firstChild;)c.appendChild(g.firstChild);return c}if("json"===g||!g&&0<=c.indexOf("json"))return Ha(N(a));("script"===g||!g&&0<=c.indexOf("javascript"))&&q(a);return a+""},g=function(a){return"/"==a.substr(0,1)?location.protocol+"//"+location.host+a:a},k=function(c,g){c.replace(b,"");if(!g.allowCache){var k=(new Date).getTime();c=d.test(c)?c.replace(d,"$1_="+k):c+(a.test(c)?"&":"?")+"_="+k}!g.data||"POST"==g.method||
g.contentType||f&&g.data instanceof window.FormData||(g.data=t(g.data)?g.data:Aa(g.data),c+=(a.test(c)?"&":"?")+g.data,g.data=null);return c},m=function(a,b,c){var g;if(!da(a)&&!u(a)&&c){var f=document.createElement("input");f.setAttribute("type","hidden");f.setAttribute("name",c);f.setAttribute("value",a);b.appendChild(f)}else if(W(a)&&c)for(f=0,g=a.length;f<g;f++)m(a[f],b,c+"["+f+"]");else if(da(a))for(f in a)a.hasOwnProperty(f)&&m(a[f],b,c?c+"["+f+"]":f)},p=function(a){for(var b,c,g={},f=0;f<a.elements.length;f++)if(b=
a.elements[f],null!==n(b,"name"))if(c="INPUT"===b.nodeName.toUpperCase()?n(b,"type").toUpperCase():"TEXT","FILE"===c)for(c=0;c<b.files.length;g[b.name]=b.files[c++].name);else if("RADIO"!==c&&"CHECKBOX"!==c||b.checked)g[b.name]=b.value;return Aa(g)},q=function(a){var b=eval;a&&(/^[^\S]*use strict/.test(a)?(b=document.createElement("script"),b.text=a,document.head.appendChild(b).parentNode.removeChild(b)):b(a))};K({$class:"Ajax",$mixins:["mixin.Promise"],_jsonpName:null,_transport:null,_opt:null,_deferred:null,
_promise:null,_timeout:null,_form:null,_removeForm:!1,$init:function(a){a.url&&(a.url=g(a.url));var b=c.exec((window?window.location.href:"").toLowerCase())||[],d=c.exec(a.url.toLowerCase());this._opt=a;!0!==a.crossDomain&&!0!==a.ignoreCrossDomain&&(a.crossDomain=!(!d||d[1]===b[1]&&d[2]===b[2]&&(d[3]||("http:"===d[1]?"80":"443"))===(b[3]||("http:"===b[1]?"80":"443"))));var h;a.files&&!f&&(a.transport="iframe");"iframe"!=a.transport||a.form?a.form&&(this._form=a.form,"POST"!=a.method||f||(a.transport=
"iframe")):(this.createForm(),a.form=this._form);if(a.form&&"iframe"!=a.transport&&"POST"==a.method)f?a.data=new FormData(a.form):(a.contentType="application/x-www-form-urlencoded",a.data=p(a.form));else if("json"==a.contentType)a.contentType=a.contentTypeHeader||"text/plain",a.data=t(a.data)?a.data:JSON.stringify(a.data);else if(Z(a.data)&&"POST"==a.method&&f)for(h in b=a.data,a.data=new FormData,b)a.data.append(h,b[h]);a.files&&this.importFiles();a.url=k(a.url,a);this._transport=h=!a.crossDomain&&
"script"!=a.transport||a.form?"iframe"==a.transport?new F.ajax.transport.IFrame(a,this.$$promise,this):new F.ajax.transport.XHR(a,this.$$promise,this):new F.ajax.transport.Script(a,this.$$promise,this);this.$$promise.done(function(a){e.trigger("success",a)});this.$$promise.fail(function(a){e.trigger("error",a)});this.$$promise.always(function(){e.trigger("end")});e.trigger("start");a.timeout&&(this._timeout=setTimeout(l(this.onTimeout,this),a.timeout));a.jsonp&&this.createJsonp();!1===e.trigger("before-send",
a,h)&&this.$$promise.reject();a.beforeSend&&!1===a.beforeSend.call(a.context,a,h)&&this.$$promise.reject();this.$$promise.isPending()?(aa(h.send,h),this.$$promise.always(this.asyncDestroy,this)):aa(this.asyncDestroy,this,[],1E3)},asyncDestroy:function(){this.$isDestroyed()||(this.$$promise.hasListeners()?aa(this.asyncDestroy,this,[],1E3):this.$destroy())},abort:function(a){this.$$promise.reject(a||"abort");this._transport.abort();return this},onTimeout:function(){this.abort("timeout")},getTransport:function(){return this._transport},
createForm:function(){var a=document.createElement("form");a.style.display="none";a.setAttribute("method",this._opt.method);a.setAttribute("enctype","multipart/form-data");m(this._opt.data,a,null);document.body.appendChild(a);this._form=a;this._removeForm=!0},importFiles:function(){var a=this._opt,b=a.files,c=this._form;a=a.data;var g,f;var d=0;for(g=b.length;d<g;d++){var k=b[d];if(W(k)){var h=k[0];k=k[1]}else h=window.File&&k instanceof File?k.uploadName||"upload"+(1<g?"[]":""):k.name||"upload"+
(1<g?"[]":"");if(!(window.File&&k instanceof File)){var e=k;k=null}if(c)e&&c.appendChild(e);else if(k)a.append(h,k);else if(e.files&&e.files.length)for(k=0,f=e.files.length;k<f;k++)a.append(h,e.files[k])}},createJsonp:function(){var b=this._opt,c=b.jsonpParam||"callback",g=b.jsonpCallback||"jsonp_"+ja();b.url+=(a.test(b.url)?"&":"?")+c+"="+g;this._jsonpName=g;"undefined"!=typeof window&&(window[g]=l(this.jsonpCallback,this));"undefined"!=typeof global&&(global[g]=l(this.jsonpCallback,this));return g},
jsonpCallback:function(a){try{var b=this.processResponseData(a)}catch(ia){this.$$promise?this.$$promise.reject(ia):ba(ia)}this.$$promise&&this.$$promise.resolve(b)},processResponseData:function(a,b){var c=this._opt;a=h(a,c,b);e.hasListener("process-response")&&e.trigger("process-response",a,this.$$promise);c.processResponse&&(a=c.processResponse.call(c.context,a,this.$$promise));return a},returnResponse:function(a,b){return this._opt.jsonp?null:this.processResponseData(a,b)},processResponse:function(a,
b){var c=this.$$promise;if(this._opt.jsonp)if(a){try{q(a)}catch(E){c.reject(E)}c.isPending()&&c.reject("jsonp script didn't invoke callback")}else c.reject("jsonp script is empty");else{try{var g=this.processResponseData(a,b)}catch(E){c.reject(E)}c.resolve(g)}},destroy:function(){this._timeout&&clearTimeout(this._timeout);this._form&&this._form.parentNode&&this._removeForm&&this._form.parentNode.removeChild(this._form);this._transport.$destroy();this._jsonpName&&("undefined"!=typeof window&&delete window[this._jsonpName],
"undefined"!=typeof global&&delete global[this._jsonpName])}},{prepareUrl:k,global:e})})();var Ia=function(){var a={url:null,data:null,method:"GET",headers:null,username:null,password:null,cache:null,dataType:null,timeout:0,contentType:null,xhrFields:null,jsonp:!1,jsonpParam:null,jsonpCallback:null,transport:null,replace:!1,selector:null,form:null,beforeSend:null,progress:null,uploadProgress:null,processResponse:null,context:null},c={},b=function(b,e){e=e||{};b&&!t(b)?e=b:e.url=b;if(!e.url&&(e.form&&
(e.url=n(e.form,"action")),!e.url))throw"Must provide url";r(e,c,!1,!0);r(e,a,!1,!0);e.method=e.method?e.method.toUpperCase():e.form?n(e.form,"method").toUpperCase()||"GET":"GET";return new F.Ajax(e)};b.setup=function(a){r(c,a,!0,!0)};b.on=function(){F.Ajax.global.on.apply(F.Ajax.global,arguments)};b.un=function(){F.Ajax.global.un.apply(F.Ajax.global,arguments)};b.get=function(a,c){c=c||{};c.method="GET";return b(a,c)};b.post=function(a,c){c=c||{};c.method="POST";return b(a,c)};b.load=function(a,
c,f){f=f||{};t(c)||(f=c);f.dataType="fragment";return b(c,f).done(function(b){if(f.replace)for(;a.firstChild;)a.removeChild(a.firstChild);a.appendChild(b)})};b.loadScript=function(a){return b(a,{transport:"script"})};b.submit=function(a,c){c=c||{};c.form=a;return b(null,c)};b.prepareUrl=function(a,b){return F.Ajax.prepareUrl(a,b||{})};return b}();v.register("validator.messages",{required:"This field is required.",remote:"Please fix this field.",email:"Please enter a valid email address.",url:"Please enter a valid URL.",
date:"Please enter a valid date.",dateISO:"Please enter a valid date (ISO).",number:"Please enter a valid number.",digits:"Please enter only digits.",creditcard:"Please enter a valid credit card number.",equalTo:"Please enter the same value again.",accept:"Please enter a value with a valid extension.",maxlength:"Please enter no more than {0} characters.",minlength:"Please enter at least {0} characters.",rangelength:"Please enter a value between {0} and {1} characters long.",range:"Please enter a value between {0} and {1}.",
max:"Please enter a value less than or equal to {0}.",min:"Please enter a value greater than or equal to {0}."});var Ja=/^(?:(?:https?|ftp):\/\/)(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})))(?::\d{2,5})?(?:\/\S*)?$/i;
v.register("validator.checkable",function(a){return/radio|checkbox/i.test(a.type)});(function(){var a=v.get("validator.checkable");return v.register("validator.getLength",function(c,b){var d=0;switch(b.nodeName.toLowerCase()){case "select":return ma(b,function(a){a.selected&&d++}),d;case "input":if(a(b)){if(b.form)ma(b.form,function(a){a.type==b.type&&a.name==b.name&&a.checked&&d++});else{var e;if(xa(b))c=b.ownerDocument;else for(c=b;c.parentNode;)c=c.parentNode;c=U("input[name="+b.name+"]",c);var f=
0;for(e=c.length;f<e;f++)c[f].checked&&d++}return d}}return c.length})})();(function(){var a=v.get("validator.checkable"),c=v.get("validator.getLength");return v.register("validator.empty",function(b,d){if(!d)return void 0==b||""===b;switch(d.nodeName.toLowerCase()){case "select":return b=V(d),!b||0==b.length;case "input":if(a(d))return 0==c(b,d)}return 0==N(b).length})})();(function(){var a=v.get("validator.empty"),c=v.get("validator.getLength");return v.register("validator.methods",{required:function(b,
c,e){return!1===e?!0:!a(b,c)},regexp:function(b,c,e){e=e instanceof RegExp?e:new RegExp(e);return a(b,c)||e.test(b)},notregexp:function(b,c,e){e=e instanceof RegExp?e:new RegExp(e);return a(b,c)||!e.test(b)},minlength:function(b,d,e){return a(b,d)||(d?c(N(b),d)>=e:b.toString().length>=e)},maxlength:function(b,d,e){return a(b,d)||(d?c(N(b),d)<=e:b.toString().length<=e)},rangelength:function(b,d,e){var f=d?c(N(b),d):b.toString().length;return a(b,d)||f>=e[0]&&f<=e[1]},min:function(b,c,e){return a(b,
c)||parseInt(b,10)>=e},max:function(b,c,e){return a(b,c)||parseInt(b,10)<=e},range:function(b,c,e){b=parseInt(b,10);return a(b,c)||b>=e[0]&&b<=e[1]},email:function(b,c){return a(b,c)||/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i.test(b)},
url:function(b,c){return a(b,c)||Ja.test(b)},date:function(b,c){return a(b,c)||!/Invalid|NaN/.test(new Date(b))},dateiso:function(b,c){return a(b,c)||/^\d{4}[\/-]\d{1,2}[\/-]\d{1,2}$/.test(b)},number:function(b,c){return a(b,c)||/^-?(?:\d+|\d{1,3}(?:,\d{3})+)(?:\.\d+)?$/.test(b)},digits:function(b,c){return a(b,c)||/^\d+$/.test(b)},creditcard:function(b,c){if(a(b,c))return!0;if(/[^0-9-]+/.test(b))return!1;c=0;var d=!1;b=b.replace(/\D/g,"");for(var f=b.length-1;0<=f;f--){var h=b.charAt(f);h=parseInt(h,
10);d&&9<(h*=2)&&(h-=9);c+=h;d=!d}return 0==c%10},accept:function(b,c,e){e=t(e)?e.replace(/,/g,"|"):"png|jpe?g|gif";return a(b,c)||b.match(new RegExp(".("+e+")$","i"))},equalto:function(a,c,e,f){e=(c=f.getValidator().getField(e))?c.getElem():e;return a==V(e)},notequalto:function(a,c,e,f){e=(c=f.getValidator().getField(e))?c.getElem():e;return a!=V(e)},zxcvbn:function(a,c,e){return zxcvbn(a).score>=parseInt(e)}})})();v.register("validator.format",function(a,c){if(u(c))return a;W(c)||(c=[c]);var b,
d=c.length;for(b=-1;++b<d;a=a.replace(new RegExp("\\{"+b+"\\}","g"),c[b]));return a});v.register("mixin.Observable",{$$observable:null,$$callbackContext:null,$$events:null,$beforeInit:function(a){this.$$observable=new ka;this.$initObservable(a)},$initObservable:function(a){var c=this.$$observable,b;if(a&&a.callback){var d=a.callback,e=d.context||d.scope||d.$context,f=r({},this.$$events,d.$events,!0,!1);for(b in f)c.createEvent(b,f[b]);d.context=null;d.scope=null;for(b in d)if(d[b])c.on(b,d[b],e||
this);a.callback=null;e&&(this.$$callbackContext=e)}else if(this.$$events)for(b in this.$$events)c.createEvent(b,this.$$events[b])},on:function(){var a=this.$$observable;return a?a.on.apply(a,arguments):null},un:function(){var a=this.$$observable;return a?a.un.apply(a,arguments):null},once:function(){var a=this.$$observable;return a?a.once.apply(a,arguments):null},trigger:function(){var a=this.$$observable;return a?a.trigger.apply(a,arguments):null},$beforeDestroy:function(){this.$$observable.trigger("before-destroy",
this)},$afterDestroy:function(){this.$$observable.trigger("destroy",this);this.$$observable.destroy();this.$$observable=null}});(function(){var a={allowSubmit:!0,alwaysCheck:!1,alwaysDisplayState:!1,data:null,ignore:null,disabled:!1,cls:{valid:"",error:"",ajax:""},errorBox:{cls:"",fn:null,tag:"",position:"after",elem:null,enabled:!0},callback:{scope:null,destroy:null,statechange:null,errorchange:null,submit:null,check:null,beforeAjax:null,afterAjax:null,displaystate:null},rules:{},messages:{}},c=
function(a){if(!a)return{};var b=function(b,c,g){var f=a[b],k=!1;if(void 0!==f){switch(g){case "string":k=t(f);break;case "function":k=u(f);break;case "boolean":k=la(f)}k&&(a[b]={},a[b][c]=f)}};b("errorBox","enabled","boolean");b("errorBox","tag","string");b("errorBox","fn","function");return a},b=v.get("validator.messages"),d=v.get("validator.methods"),e=v.get("validator.empty"),f=v.get("validator.format"),h=K({$class:"validator.Field",$mixins:["mixin.Observable"],vldr:null,elem:null,rules:null,
cfg:null,input:null,enabled:!0,valid:null,dirty:!1,id:null,prev:"",error:null,errorRule:null,pending:null,rulesNum:0,displayState:!1,data:null,checking:!1,checkTmt:null,errorBox:null,customError:!1,$init:function(g,f,d){f=f||{};var k;this.cfg=k=r({},a,c(h.defaults),c(f),!0,!0);this.input=Y.get(g);this.input.onChange(this.onInputChange,this);this.input.onKey(13,this.onInputSubmit,this);this.elem=g;this.vldr=d;this.enabled=!g.disabled;this.id=n(g,"name")||n(g,"id");this.data=f.data;this.rules={};k.messages=
r({},b,k.messages,!0,!0);f=d.getVldId();g.setAttribute("data-validator",f);this.input.radio&&this.initRadio();k.rules&&this.setRules(k.rules,!1);this.readRules();this.prev=this.input.getValue();k.disabled&&this.disable()},getValidator:function(){return this.vldr},initRadio:function(){var a=this.input.radio,b=this.vldr.getVldId(),c;var f=0;for(c=a.length;f<c;f++)a[f].setAttribute("data-validator",b)},setRules:function(a,b){b=void 0==b?!0:b;for(var c in a)this.setRule(c,a[c],!1);b?this.check(!1):this.setValidState(null);
return this},setRule:function(a,b,c){var g=this.rules;c=void 0==c?!0:c;null===b?(g[a]&&this.rulesNum--,delete g[a]):(g[a]||this.rulesNum++,g[a]=b,null!==this.valid&&this.setValidState(!1));c?this.check(!1):this.setValidState(null);return this},setMessage:function(a,b){this.cfg.messages[a]=b;return this},setMessages:function(a){for(var b in a)this.setMessage(b,a[b]);return this},getMessages:function(){return r({},this.cfg.messages)},readRules:function(){var a=this.elem,b=a.className,c={};for(h in d)if(d.hasOwnProperty(h)){var f=
n(a,h)||n(a,"data-validate-"+h);void 0!=f&&!1!==f&&("minlength"!=h&&"maxlength"!=h||-1!=parseInt(f,10))&&(c[h]=f,(f=n(a,"data-message-"+h))&&this.setMessage(h,f))}if(f=n(a,"remote"))c.remote=f;if(b){b=b.split(" ");var h=0;for(f=b.length;h<f;h++)if(a=N(b[h]),d[a]||"remote"==a)c[a]=!0}for(h in c)this.setRule(h,c[h],!1)},getRules:function(){return this.rules},hasRule:function(a){return this.rules[a]?!0:!1},getValue:function(){return this.input.getValue()},getUserData:function(){return this.data},setUserData:function(a){var b=
this.data;this.data=a;return b},isEmpty:function(){return e(this.getValue(),this.elem)},enable:function(){this.enabled=!0;this.vldr.reset();return this},disable:function(){this.enabled=!1;!1===this.valid&&(this.setValidState(!0),this.doDisplayState());return this},enableDisplayState:function(){this.displayState=!0},disableDisplayState:function(){this.displayState=!1},isDisplayStateEnabled:function(){return this.displayState},toggleErrorBox:function(a){var b=this.cfg,c=b.errorBox.enabled;b.errorBox.enabled=
a;!c&&a&&a.displayState&&!1===this.valid()&&this.doDisplayState()},isEnabled:function(){return this.enabled},getElem:function(){return this.elem},getName:function(){return this.id},getError:function(){return this.error},getErrorRule:function(){return this.errorRule},isValid:function(){return this.isEnabled()?this.customError?!1:!0===this.valid&&!this.pending||0===this.rulesNum:!0},getExactValidState:function(){return this.valid},setCustomError:function(a,b){this.customError=a?!0:!1;this.setValidState(a?
!1:!0);this.setError(!0===a?null:a,b);this.doDisplayState()},reset:function(){this.abort();this.dirty=!1;this.prev="";this.setValidState(null);this.setError(null);this.doDisplayState();return this},abort:function(){this.pending&&(this.pending.abort(),this.pending=null);return this},check:function(a){var b=this.rules,c=this.cfg,g=this.elem;if(!this.isEnabled())return!0;if(this.customError)return!1;if(0==this.rulesNum&&!1!==this.valid)return!0;if(this.checking)return this.checkTmt||(this.checkTmt=setTimeout(l(this.checkTimeout,
this),100)),!0===this.valid;this.checking=!0;if(!(!0===a||b.equalTo||b.notEqualTo||this.dirty||null===this.valid||c.alwaysCheck))return this.pending||this.doDisplayState(),this.checking=!1,!0===this.valid;var h=!0,e=!1,n=this.getValue(),t,r;for(r in b)if("remote"==r){if(this.dirty||c.alwaysCheck||null===this.valid||!0===a)if(n||b[r].checkEmpty)e=!0}else if(!0!==(t=(u(b[r])?b[r]:d[r]).call(this.$$callbackContext,n,g,b[r],this))){h=!1;this.setError(f(t||c.messages[r]||"",b[r]),r);break}e=e&&h;h&&this.setError(null);
e?this.ajaxCheck():(this.setValidState(h),this.doDisplayState());this.checking=this.dirty=!1;this.trigger("check",this,this.valid);return!0===this.valid&&!e},doDisplayState:function(){var a=this.cfg,b=this.isValid(),c=a.cls.error,f=a.cls.valid,h=this.elem;this.displayState||a.alwaysDisplayState||(b=null);null===this.valid&&(b=null);c&&(!1===b?M(h,c):I(h,c));f&&(!0===b?M(h,f):I(h,f));c=this.getErrorBox();f=this.error;c&&(!1===b&&f&&(c.innerHTML=state.error),c.style.display=!1===b&&f&&a.errorBox.enabled?
"block":"none");this.trigger("display-state",this,b,this.error)},getErrorBox:function(){var a=this.cfg.errorBox;return a.tag||a.fn||a.selector?(!this.errorBox&&a.enabled&&this.createErrorBox(),this.errorBox):null},destroy:function(){this.elem.removeAttribute("data-validator");this.errorBox&&this.errorBox.parentNode.removeChild(this.errorBox);this.input.destroy()},isPending:function(){return null!==this.pending},setValidState:function(a){this.valid!==a&&(this.valid=a,this.trigger("state-change",this,
a))},setError:function(a,b){if(this.error!=a||this.errorRule!=b)this.error=a,this.errorRule=b,this.trigger("error-change",this,a,b)},checkTimeout:function(){this.checkTmt=null;this.checking||this.check(!1)},onInputChange:function(a){this.prev!==a&&(this.dirty=!0,this.customError=!1,this.abort(),this.pending||this.check(!1),this.prev=this.input.getValue())},onInputSubmit:function(a){a=new L(a);if(!(a.isDefaultPrevented&&a.isDefaultPrevented()||!1!==this.trigger("submit",this,a)))return a.preventDefault(),
!1},createErrorBox:function(){var a=this.cfg.errorBox,b=a.tag,c=a.cls,f=a.fn,h=a.position;a=a.elem;f?this.errorBox=f.call(this.$$callbackContext,this):a?this.errorBox=a:(this.errorBox=window.document.createElement(b),this.errorBox.className=c,b=(b=this.input.radio)?b[b-1]:this.elem,"appendParent"==h?b.parentNode.appendChild(this.errorBox):"before"==h?b.parentNode.insertBefore(this.errorBox,b):b.parentNode.insertBefore(this.errorBox,b.nextSibling))},ajaxCheck:function(){var a=this.elem,b=this.rules.remote,
c=this.getValue(),f=this.cfg;b=r({},t(b)?{url:b}:b,!0);b.data=b.data||{};b.data[b.paramName||n(a,"name")||n(a,"id")]=c;b.handler||(b.dataType="text");b.cache=!1;f.cls.ajax&&M(a,f.cls.ajax);this.trigger("before-ajax",this,b);this.pending=Ia(b);this.pending.done(l(this.onAjaxSuccess,this));this.pending.fail(l(this.onAjaxError,this))},onAjaxSuccess:function(a){var b=this.rules,c=this.cfg;this.pending=null;var g=!0;b.remote.handler?(a=b.remote.handler.call(this.$$callbackContext,this,a),!0!==a&&(this.setError(f(a||
c.messages.remote||"",b.remote),"remote"),g=!1)):a?(this.setError(a,"remote"),g=!1):this.setError(null);c.cls.ajax&&I(this.elem,c.cls.ajax);this.setValidState(g);this.doDisplayState();this.trigger("after-ajax",this)},onAjaxError:function(a,b){var c=this.cfg,g=a.responseData,h=this.rules;g&&h.remote.handler&&(g=h.remote.handler.call(this.$$callbackContext,this,g),!0!==g&&this.setError(f(g||c.messages.remote||"",h.remote),"remote"));c.cls.ajax&&I(this.elem,c.cls.ajax);this.pending=null;"abort"!=b&&
"abort"!=a&&(this.setValidState(!1),this.doDisplayState(),this.trigger("after-ajax",this))}},{defaults:{},messages:{}});return h})();(function(){var a={alwaysCheck:!1,alwaysDisplayState:!1,disabled:!1,value:null,elem:null,errorBox:null,errorField:null,data:null,cls:{valid:"",error:""},fields:[],rules:{},messages:{},callback:{scope:null,destroy:null,statechange:null,errorchange:null,displaystate:null}},c=v.get("validator.messages"),b=v.get("validator.methods"),d=v.get("validator.format"),e=K({$class:"validator.Group",
$mixins:["mixin.Observable"],fields:null,rules:null,cfg:null,vldr:null,enabled:!1,invalid:null,valid:null,displayState:!1,rulesNum:0,error:null,data:null,errorBox:null,el:null,$init:function(b,h){b=b||{};var f;this._vldr=h;this.cfg=f=r({},a,e.defaults,b,!0,!0);this.data=b.data;this.el=b.elem;this.fields={};this.rules={};f.messages=r({},c,f.messages,!0,!0);f.rules&&this.setRules(f.rules,!1);if(f.fields){var d=0;for(b=b.fields.length;d<b;d++)this.add(h.getField(f.fields[d]))}this.enabled=!f.disabled},
enable:function(){this.enabled=!0;return this},disable:function(){this.enabled=!1;return this},isEnabled:function(){return this.enabled},isValid:function(){return!this.enabled||0===this.invalid&&!0===this.valid},getExactValidState:function(){return this.valid},reset:function(){this.invalid=0;this.setValidState(null);this.setError(null);this.doDisplayState();return this},getUserData:function(){return this.data},getName:function(){return this.cfg.name},setRules:function(a,b){b=void 0==b?!0:b;for(var c in a)this.setRule(c,
a[c],!1);b?this.check():this.setValidState(null);return this},setRule:function(a,b,c){var f=this.rules;c=void 0==c?!0:c;null===b?(f[a]&&this.rulesNum--,delete f[a]):(f[a]||this.rulesNum++,f[a]=b,null!==this.valid&&this.setValidState(!1));c?this.check():this.setValidState(null);return this},getRules:function(){return r({},this.rules)},hasRule:function(a){return this.rules[a]?!0:!1},setError:function(a){var b=this.cfg;this.error!=a&&(b.errorField?(this.vldr.getField(b.errorField).setError(a),this.error=
null):(this.error=a,this.trigger("error-change",this,a)))},getError:function(){return this.error},getFields:function(){return this.fields},enableDisplayState:function(){this.displayState=!0;return this},disableDisplayState:function(){this.displayState=!1;return this},check:function(){var a=this.cfg,c=this.fields,g=this.rules;if(!this.enabled||0==this.rulesNum)return this.setValidState(null),this.doDisplayState(),!0;this.countInvalid();if(0<this.invalid)return this.setValidState(null),this.doDisplayState(),
!0;var e={},m=!0,l=null,q;if(a.value){for(q in c)e[q]=c[q].getValue();l=a.value.call(this.$$callbackContext,e,this)}for(q in g)if(!0!==(c=(u(g[q])?g[q]:b[q]).call(this.$$callbackContext,l,null,g[q],this,e))){m=!1;c||a.messages[q]?this.setError(d(c||a.messages[q]||"",g[q])):this.setError(null);break}m&&this.setError(null);this.setValidState(m);this.doDisplayState();return!0===this.valid},doDisplayState:function(){var a=this.valid,b=this.cfg;this.displayState||b.alwaysDisplayState||(a=null);if(b.errorBox){var c=
this.getErrorBox();null!==a?c&&(c.innerHTML=this.error||"",c.style.display=!1===this.valid?"block":"none"):c&&(c.style.display="none")}c=b.cls.error;b=b.cls.valid;a=this.valid;c&&(!1===a?M(this.el,c):I(this.el,c));b&&(!0===a?M(this.el,b):I(this.el,b));this.trigger("display-state",this,this.valid)},getErrorBox:function(){var a=this.cfg,b=this.fields,c=a.errorBox;if(b[c])return b[c].getErrorBox();this.errorBox||(u(a.errorBox)?this.errorBox=a.errorBox.call(this.$$callbackContext,this):this.errorBox=
a.errorBox);return this.errorBox},destroy:function(){var a=this.fields,b;for(b in a)a[b]&&this.setFieldEvents(a[b],"un");this.errorBox&&this.errorBox.parentNode.removeChild(this.errorBox)},add:function(a){var b=this.fields,c=a.getName();b[c]||(b[c]=a,this.setFieldEvents(a,"on"))},setFieldEvents:function(a,b){a[b]("state-change",this.onFieldStateChange,this)},remove:function(a){var b=this.fields,c=a.getName();b[c]&&(delete b[c],this.setFieldEvents(a,"un"));return this},setValidState:function(a){this.valid!==
a&&(this.valid=a,this.trigger("state-change",this,a))},countInvalid:function(){var a=this.fields;this.invalid=0;for(var b in a)this.invalid+=a[b].isValid()?0:1},onFieldStateChange:function(a,b){this.trigger("field-state-change",this,a,b);this.check()}},{defaults:{}});return e})();oa=function(){var a={},c=F.validator.Field,b=F.validator.Group,d={form:null,all:{},fields:{},rules:{},cls:{valid:"",error:"",checking:""},groups:{},callback:{scope:null,destroy:null,reset:null,beforesubmit:null,submit:null,
statechange:null,check:null,displaystate:null,displaystatechange:null}},e=K({$class:"Validator",$mixins:["mixin.Observable"],id:null,el:null,cfg:null,enabled:!1,invalid:null,pending:0,grps:0,outside:!0,submitted:!1,displayState:!1,isForm:!1,isField:!1,submitButton:null,hidden:null,preventFormSubmit:!1,fields:null,groups:null,$init:function(b,c,g){var f=b.nodeName.toLowerCase();this.id=ja();a[this.id]=this;b.setAttribute("data-validator",this.id);this.el=b;c&&!t(c)&&(g=c,c=null);this.cfg=b=r({},d,
e.defaults,e[c],g,!0,!0);this.$initObservable(b);this.isForm="form"===f;this.isField=/input|select|textarea/.test(f);this.fields={};this.groups={};this.$$observable.createEvent("submit",!1);this.$$observable.createEvent("beforesubmit",!1);this.onRealSubmitClickDelegate=l(this.onRealSubmitClick,this);this.resetDelegate=l(this.reset,this);this.onSubmitClickDelegate=l(this.onSubmitClick,this);this.onFormSubmitDelegate=l(this.onFormSubmit,this);var h;this.initFields();f=this.fields;for(h in b.rules)f[h]&&
f[h].setRules(b.rules[h],!1);b.rules=null;for(h in b.groups)this.addGroup(h,b.groups[h]);this.initForm("bind");delete b.rules;delete b.fields;delete b.groups;this.enabled=!0},getVldId:function(){return this.id},getElem:function(){return this.el},getGroup:function(a){return this.groups[a]||null},getField:function(a){return this.fields[a]||null},enable:function(){this.enabled=!0;return this},disable:function(){this.enabled=!1;return this},isEnabled:function(){return this.enabled},enableDisplayState:function(){var a=
this.fields,b=this.groups,c;if(!0!==this.displayState){this.displayState=!0;for(c in a)a[c].enableDisplayState();for(c in b)b[c].enableDisplayState();this.trigger("display-state-change",this,!0)}return this},disableDisplayState:function(){var a=this.groups,b=this.fields,c;if(!1!==this.displayState){this.displayState=!1;for(c in b)b[c].disableDisplayState();for(c in a)a[c].disableDisplayState();this.trigger("display-state-change",this,!1)}return this},isDisplayStateEnabled:function(){return this.displayState},
isValid:function(){return!1===this.enabled?!0:0===this.invalid&&0===this.pending&&0===this.grps&&!0===this.outside},getErrors:function(a){var b=!0===a?[]:{},c,f,d,e=[this.fields,this.groups];if(!this.isEnabled())return b;for(d=0;2>d;d++){var l=e[d];for(f in l)null===l[f].getExactValidState()&&l[f].check(),l[f].isValid()||(c=l[f].getError())&&(a?b.push(c):b[f]=c)}return b},check:function(){var a=this.fields,b=this.groups;if(!this.isEnabled())return!0;var c=this.isValid(),d;for(d in a)a[d].check();
for(d in b)b[d].check();this.outside=!1!==this.trigger("check",this);a=this.isValid();c!=a&&(this.doDisplayState(),this.trigger("state-change",this,!1));return a},add:function(a,b){var f=a.nodeName.toLowerCase(),d=a.type;if("input"!=f&&"textarea"!=f&&"select"!=f||"submit"==d||"reset"==d||"button"==d||null!==n(a,"data-no-validate")||null!==n(a,"data-validator"))return this;d=n(a,"name")||n(a,"id");var e=this.cfg;f=this.fields;if(!d)return this;b=e.fields&&e.fields[d]?e.fields[d]:b||{};t(b)&&(b={rules:[b]});
b=r({},e.all||{},b,!0,!0);if(b.ignore)return this;b.callback||(b.callback={context:this.$$callbackContext});a=new c(a,b,this);d=a.getName();if(f[d])return this;f[d]=a;this.setFieldEvents(a,"on");this.displayState&&a.enableDisplayState();this.isEnabled()&&null!==this.invalid&&a.check();return this},addGroup:function(a,c){var f=this.groups;f[a]||(c.name=a,f[a]=new b(c,this),this.setGroupEvents(f[a],"on"),this.isEnabled()&&null!==this.invalid&&f[a].check())},focusInvalid:function(){var a=this.fields,
b;for(b in a)if(!a[b].isValid()){a[b].getElem().focus();break}},reset:function(){var a=this.fields,b=this.groups,c;this.submitted=!1;this.disableDisplayState();for(c in b)b[c].reset();for(c in a)a[c].reset();this.pending=0;this.invalid=null;this.grps=0;this.outside=!1;this.doDisplayState();this.trigger("reset",this);return this},submit:function(){var a=this.el;if(this.isForm)if(u(a.submit))!1!==this.trigger("before-submit",this)&&!1!==this.trigger("submit",this)&&a.submit();else this.onSubmit();else this.onSubmit()},
setFieldEvents:function(a,b){a[b]("state-change",this.onFieldStateChange,this);a[b]("before-ajax",this.onBeforeAjax,this);a[b]("after-ajax",this.onAfterAjax,this);a[b]("submit",this.onFieldSubmit,this);a[b]("destroy",this.onFieldDestroy,this);a[b]("error-change",this.onFieldErrorChange,this)},setGroupEvents:function(a,b){a[b]("state-change",this.onGroupStateChange,this)},initFields:function(){var a=this.el,b;if(this.isField)return this.add(a),this;a=U("input, textarea, select",a);var c=-1;for(b=a.length;++c<
b;this.add(a[c]));return this},initForm:function(a){var b=this.el,c=b.getElementsByTagName("input"),f=U(".submit",b),d=U(".reset",b);a="bind"===a?T:ua;var e;var l=0;for(e=c.length;l<e;l++){var n=c[l];var r=n.type;"submit"===r?a(n,"click",this.onRealSubmitClickDelegate):"reset"===r&&a(n,"click",this.resetDelegate)}l=-1;for(e=f.length;++l<e;"submit"!==f[l].type&&a(f[l],"click",this.onSubmitClickDelegate));l=-1;for(e=d.length;++l<e;"reset"!==d[l].type&&a(d[l],"click",this.resetDelegate));this.isForm&&
a(b,"submit",this.onFormSubmitDelegate)},onRealSubmitClick:function(a){a=new L(a||window.event);this.submitButton=a.target||a.srcElement;this.preventFormSubmit=!1;return this.onSubmit(a)},onSubmitClick:function(a){this.preventFormSubmit=!1;return this.onSubmit(new L(a||window.event))},onFormSubmit:function(a){a=new L(a);if(!this.isValid()||this.preventFormSubmit)return a.preventDefault(),!1},onFieldSubmit:function(a,b){this.preventFormSubmit=!1;this.enableDisplayState();this.submitted=!0;return this.onSubmit(b)},
onSubmit:function(a){this.enableDisplayState();this.isForm||(a&&a.preventDefault(),a&&a.stopPropagation());if(this.pending)return a&&a.preventDefault(),!1;var b=!!this.submitButton;this.isForm&&(this.hidden&&(this.el.removeChild(this.hidden),this.hidden=null),this.submitButton&&/input|button/.test(this.submitButton.nodeName)&&(this.hidden=window.document.createElement("input"),this.hidden.type="hidden",this.hidden.setAttribute("name",this.submitButton.name),this.hidden.value=this.submitButton.value,
this.el.appendChild(this.hidden)));this.submitButton=null;if(!this.isValid()&&(this.check(),this.onFieldStateChange(),this.pending))return this.submitted=!0,a&&a.preventDefault(),!1;if(!1===this.trigger("before-submit",this)||!this.isValid())return a&&(a.preventDefault(),a.stopPropagation()),this.pending||(this.focusInvalid(),this.submitted=!1),this.trigger("failed-submit",this,b),!1;this.pending||(this.submitted=!1);a=this.trigger("submit",this);this.preventFormSubmit=!1===a;return this.isForm?a:
!1},onFieldDestroy:function(a){a=a.getElem();a=n(a,"name")||n(a,"id");delete this.fields[a]},onFieldErrorChange:function(a,b){this.trigger("field-error-change",this,a,b)},onFieldStateChange:function(a,b){var c=this.invalid,d=this.fields;this.invalid=0;for(var f in d)this.invalid+=d[f].isValid()?0:1;a&&this.trigger("field-state-change",this,a,b);if(null===c||null!==c&&this.invalid!==c)this.doDisplayState(),this.trigger("state-change",this,this.isValid())},onGroupStateChange:function(){var a=this.groups,
b=this.grps;this.grps=0;for(var c in a)this.grps+=a[c].isValid()?0:1;if(null===b||null!==b&&this.grps!==b)this.doDisplayState(),this.trigger("state-change",this,this.isValid())},doDisplayState:function(){var a=this.cfg,b=this.isValid(),c=a.cls.error;a=a.cls.valid;var d=this.el;if(this.isField||!this.displayState)b=null;null===this.invalid&&(b=null);c&&(!1===b?M(d,c):I(d,c));a&&(!0===b?M(d,a):I(d,a));this.trigger("display-state",this,b)},onBeforeAjax:function(){this.pending++;this.cfg.cls.ajax&&M(this.el,
this.cfg.cls.ajax)},onAfterAjax:function(){var a=this.fields,b=this.cfg;this.pending=0;for(var c in a)this.pending+=a[c].isPending()?1:0;this.doDisplayState();b.cls.ajax&&I(this.el,b.cls.ajax);this.submitted&&0==this.pending&&(this.submitted=!1,this.isValid()?this.submit():this.focusInvalid())},destroy:function(){var b=this.groups,c=this.fields,d;this.reset();delete a[this.id];for(d in b)b.hasOwnProperty(d)&&b[d]&&(this.setGroupEvents(b[d],"un"),b[d].destroy());for(d in c)c.hasOwnProperty(d)&&c[d]&&
(this.setFieldEvents(c[d],"un"),c[d].destroy());this.initForm("unbind");this.cfg=this.el=this.groups=this.fields=null}},{defaults:{},addMethod:function(a,b,c){var d=v.get("validator.methods");d[a]||(d[a]=b,c&&(e.messages[a]=c))},getValidator:function(b){b=n(b,"data-validator");return a[b]||null}});return e}();var qa={};qa.Validator=oa;"undefined"!=typeof global?global.MetaphorJs=qa:window.MetaphorJs=qa})();
